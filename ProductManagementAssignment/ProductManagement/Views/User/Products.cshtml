@model IEnumerable<ProductManagement.Models.Products>

@{
    ViewBag.Title = "Product List";
}

@section stylesheets{
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.23/css/jquery.dataTables.min.css" />
}

<div class="py-5 px-3">
    <h2>Product Lists</h2>
    <hr class="mb-5" />

    <div class="container-fluid row">
        <table id="employeeTable" class="table table-bordered table-hover">
            <thead class="thead-blue">
                <tr>
                    <th>@Html.DisplayNameFor(model => model.Name)</th>
                    <th>@Html.DisplayNameFor(model => model.Category)</th>
                    <th>@Html.DisplayNameFor(model => model.Price)</th>
                    <th>@Html.DisplayNameFor(model => model.Quantity)</th>
                    <th>@Html.DisplayNameFor(model => model.Description)</th>
                    <th>@Html.DisplayNameFor(model => model.ImagePath)</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody class="">
                @foreach (var item in Model)
                {
                    <tr>
                        <td>@Html.DisplayFor(modelItem => item.Name)</td>
                        <td>
                            @item.Categories.Where(x => x.Id == item.Category).First().Name.ToString()
                        </td>
                        <td>@Html.DisplayFor(modelItem => item.Price)</td>
                        <td>@Html.DisplayFor(modelItem => item.Quantity)</td>
                        <td>@Html.DisplayFor(modelItem => item.Description)</td>
                        <td>
                            <img src="@item.ImagePath" alt="@item.Name" height="100" width="100" class="product-image" />
                        </td>
                        <td>
                            @Html.ActionLink("Edit", "EditProduct", new { id = item.Id }) |

                            @*<a href="*" onclick="deleting(event)" id="@item.Id">Delete</a>*@
                            @Html.ActionLink("Delete", "DeleteProduct", new { id = item.Id }, new { onclick = "deleting(event)" })
                        </td>
                    </tr>
                }
            </tbody>
        </table>

    </div>
</div>

<div class="toast toast-add" role="alert" aria-live="assertive" aria-atomic="true" data-delay="3000" data-animation="false">
    <div class="toast-header">
        <p class="mr-auto font-weight-bold m-0">Product Added !!</p>
        <button type="button" class="ml-3 mb-1 close" data-dismiss="toast" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="toast-body">
        <p class="m-0">Product Added</p>
    </div>
</div>

<div class="toast toast-edit" role="alert" aria-live="assertive" aria-atomic="true" data-delay="3000" data-animation="false">
    <div class="toast-header">
        <p class="mr-auto font-weight-bold m-0">Product Updated !!</p>
        <button type="button" class="ml-3 mb-1 close" data-dismiss="toast" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="toast-body">
        <p class="m-0">Product Updated</p>
    </div>
</div>

<div class="toast toast-delete" role="alert" aria-live="assertive" aria-atomic="true" data-delay="3000" data-animation="false">
    <div class="toast-header">
        <p class="mr-auto font-weight-bold m-0">Product Deleted !!</p>
        <button type="button" class="ml-3 mb-1 close" data-dismiss="toast" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="toast-body">
        <p class="m-0">Product Deleted</p>
    </div>
</div>



@section scripts{
    <script src="https://cdn.datatables.net/1.10.23/js/jquery.dataTables.min.js"></script>
    <script>
        $(document).ready(function () {
            $("#employeeTable").DataTable();
        });
    </script>
    @if (TempData.ContainsKey("productAdded"))
    {
        <script>
            if ("@TempData.Peek("productAdded").ToString()" == "True")
            {
                $(".toast-add").toast("show");
                @TempData.Remove("productAdded")
            }
        </script>
    }
    @if (TempData.ContainsKey("productEdited"))
    {
        <script>
            if ("@TempData.Peek("productEdited").ToString()" == "True")
            {
                $(".toast-edit").toast("show");
                @TempData.Remove("productEdited")
            }
        </script>
    }
    @if (TempData.ContainsKey("productDeleted"))
    {
        <script>
            if ("@TempData.Peek("productDeleted").ToString()" == "True")
            {
                $(".toast-delete").toast("show");
                @TempData.Remove("productDeleted")
            }
        </script>
    }
    <script>
        const deleting = function (e) {
            e.preventDefault();
            const reply = confirm("Are you sure you want to delete this product ?");
            if (reply) {
                window.location.href = e.target.href;
            }
        }
    </script>
}
